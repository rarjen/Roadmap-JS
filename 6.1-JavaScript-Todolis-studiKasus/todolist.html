<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ToDoList</title>
  </head>
  <body>
    <form name="todoForm">
      <table>
        <tbody>
          <tr>
            <td><label for="todo">Todo:</label></td>
            <td><input type="text" id="todo" name="todo" /></td>
          </tr>
          <tr>
            <td></td>
            <td><input type="submit" value="Add" /></td>
          </tr>
        </tbody>
      </table>
    </form>

    <h1>TodoList</h1>

    <table>
      <thead>
        <tr>
          <th>Filter</th>
          <th><input type="text" name="search" id="search" /></th>
        </tr>
      </thead>
      <tbody id="todolistBody">
        <tr>
          <td><input type="button" value="Done" /></td>
          <td>Todo Description</td>
        </tr>
      </tbody>
    </table>

    <script>
      const todoList = [
        "Belajar JavaScript Dasar",
        "Belajar JavaScript OOP",
        "Belajar JavaScript DOM",
      ]; // untuk menampung semua data yg diinput

      // function untuk clear firstChild todolist (menghapus tr nya)
      function clearTodolist() {
        const todolistBody = document.getElementById("todolistBody"); // mengambil todolistBody
        // melakukan cek apakah todoListBody firstChild masih ada?, jika ada
        // kita akan melakukan remove firstChild
        while (todolistBody.firstChild) {
          todolistBody.removeChild(todolistBody.firstChild);
        }
      }

      function removeTodolist(index) {
        todoList.splice(index, 1); // mengambil index dan hanya 1 record yang akan dihapus
        displayTodolist();
      }

      //function add todolist
      function addTodolist(index, todo) {
        const tr = document.createElement("tr"); // membuat element tr
        const tdButton = document.createElement("td"); // membuat element td untuk button
        tr.appendChild(tdButton); // memasukkan tdButton sebagai childNode dari tr

        const buttonDone = document.createElement("input");
        // set Attribute input
        buttonDone.type = "button";
        buttonDone.value = "Done";
        buttonDone.onclick = function () {
          removeTodolist(index);
        }; // melakukan remove saat button di click
        tdButton.appendChild(buttonDone);

        const tdTodo = document.createElement("td");
        tdTodo.textContent = todo; // melakukan set Todo Description dengan value di dlm todo
        tr.appendChild(tdTodo); // memasukkan tdTodo sebagai childNode dari tr

        const todolistBody = document.getElementById("todolistBody");
        todolistBody.appendChild(tr);
      }

      // function untuk menampilkan todoList (menggunakan for loop untuk mendapatkan indexnya juga)
      function displayTodolist() {
        clearTodolist(); // memanggil function clear firstchild

        // melakukan iterasi dari data index ke 0 sampai kurang dari panjangnya
        for (let i = 0; i < todoList.length; i++) {
          const todo = todoList[i];

          // const searchText = document.getElementById("search").value.toLowerCase().
          const searchText = document
            .getElementById("search")
            .value.toLowerCase(); // mengambil value dari element search, dengan lowercase

          // pengecekan bila todoLowercase itu mengandung text pada searchText
          if (todo.toLocaleLowerCase().includes(searchText)) {
            addTodolist(i, todo); // mengirim value juga indexnya
          }
        }
      }

      // function submit pada form todoForm (memasukkan data ke array todoList)
      document.forms["todoForm"].onsubmit = function (event) {
        event.preventDefault(); // mencegah agar html melakukan submit, hanya akan di eksekusi oleh JS

        const todo = document.forms["todoForm"]["todo"].value; // mengambil value dari input via form name
        todoList.push(todo); // memasukkan data kedalam array todoList

        document.forms["todoForm"].reset(); // clear field pada todo begitu ditambahkan (submit)

        console.info(todoList);

        displayTodolist();
      };

      // menampilkan data ketika keyup dan keydown
      const searchInput = document.getElementById("search");
      searchInput.onkeyup = function () {
        displayTodolist();
      };

      searchInput.onkeydow = function () {
        displayTodolist();
      };

      displayTodolist();

      // Menampilkan data todoList
    </script>
  </body>
</html>
